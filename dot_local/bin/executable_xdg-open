#!/bin/zsh

set -e

File=$1

if [[ -z $File ]]; then
    echo "No file specified" 1>&2
    exit 1
fi


if [[ -e $File ]]; then
    FilePath=$(readlink -f "$File")
    FileWin=$(wslpath -w "$FilePath")
elif [[ $File == file://* ]]; then
    FilePath=$(readlink -f "${File##*://}")
    FileWin=$(wslpath -w "$FilePath")
else
    FileWin=$File
fi

explorer.exe "${FileWin}"
